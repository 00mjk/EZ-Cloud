(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{2675:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.safePngBase64?i("q-img",{style:"width: "+e.size+"px; max-height: "+e.size+"px",attrs:{src:e.safePngBase64,contain:""}}):e._e()},n=[],r=(i("b7ef"),{name:"IconPicture",props:{pngBase64:{type:String,default:null},size:{type:Number,default:40}},computed:{safePngBase64(){let e=null;if(this.pngBase64&&this.pngBase64.length)try{const t=btoa(atob(this.pngBase64));e=`data:image/png;base64,${t}`}catch(t){}return e}}}),s=r,c=i("2877"),o=i("068f"),l=i("eebe"),p=i.n(l),d=Object(c["a"])(s,a,n,!1,null,null,null);t["a"]=d.exports;p()(d,"components",{QImg:o["a"]})},a87d:function(e,t,i){"use strict";t["a"]={computed:{darkMode:{get(){return this.$q.dark.isActive},set(e){this.$q.dark.set(e),localStorage.setItem("settings.darkMode",e)}}}}},da35:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{domProps:{innerHTML:e._s(e.identiconAsSvg)}})},n=[],r=i("cd07"),s={name:"Identicon",props:{identity:{type:String,default:null}},computed:{identiconAsSvg(){return Object(r["a"])(this.identity,50)}}},c=s,o=i("2877"),l=Object(o["a"])(c,a,n,!1,null,null,null);t["a"]=l.exports},fdcc:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{staticClass:"q-pa-xl"},[i("q-header",{class:e.darkMode?"":"bg-grey-1",style:e.darkMode?"background: var(--q-color-dark);":"",attrs:{elevated:""}},[i("q-toolbar",{staticClass:"q-gutter-x-sm",class:e.darkMode?"":"text-black"},[i("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"arrow_back",label:"Return to Pipeline Templates",to:"/Admin/PipelineTemplates"}}),i("q-separator",{attrs:{vertical:""}}),i("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"save",label:"Save",color:"primary",disabled:!e.needsSaving},on:{click:function(t){return e.save()}}}),i("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"restore",label:"Reverse to last saved"},on:{click:function(t){return e.reverseToLastSaved()}}}),i("q-toolbar-title",{staticClass:"text-center",staticStyle:{opacity:".4"}},[e._v("Admin : Pipeline Templates : Review Template"),e.pipelineTemplateName&&e.pipelineTemplateName.length?i("span",[e._v(":  "+e._s(e.pipelineTemplateName))]):e._e()])],1)],1),i("div",{staticClass:"q-gutter-sm"},[i("q-card",{staticClass:"q-pa-md q-mx-none"},[i("q-card-section",{attrs:{horizontal:""}},[i("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[i("q-card-section",{staticClass:"text-h4"},[e._v("\n              Properties\n          ")]),i("q-card-section",[i("span",{staticClass:"text-bold"},[e._v("pipelineTemplateUid:")]),e._v(" "+e._s(e.pipelineTemplateUid)+"\n          ")]),i("q-card-section",[i("pre",[e._v(e._s(e.pipelineTemplate))])]),i("q-card-section",[i("Identicon",{attrs:{identity:e.pipelineTemplate.publisherName}})],1)],1)],1)],1),i("q-card",{staticClass:"q-pa-md q-mx-none"},[i("q-card-section",{attrs:{horizontal:""}},[i("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[i("q-card-section",{staticClass:"text-h4 row"},[e._v("\n              Icon / Logo\n            "),i("q-space"),e.pictureNeedsSaving?i("q-icon",{attrs:{name:"save_as",color:"positive"}},[i("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[e._v("\n                Needs saving\n              ")])],1):e._e()],1),i("q-card-section",{staticClass:"row q-gutter-x-lg"},[i("div",[i("div",{staticClass:"text-h6 text-center"},[e._v("\n                Current\n              ")]),i("q-separator",{attrs:{spaced:""}}),i("div",{staticClass:"row q-gutter-md"},[i("div",{staticClass:"text-center",staticStyle:{"min-width":"70px"}},[i("div",[e._v("70x70")]),i("IconPicture",{attrs:{pngBase64:e.pipelineTemplate.pipelineTemplateIconPicture,size:70}})],1),i("div",{staticClass:"text-center",staticStyle:{"min-width":"150px"}},[i("div",[e._v("150x150")]),i("IconPicture",{attrs:{pngBase64:e.pipelineTemplate.pipelineTemplateIconPicture,size:150}})],1)])],1),e.pictureImportPanel?i("q-separator",{attrs:{vertical:""}}):e._e(),e.pictureImportPanel?i("div",[i("div",{staticClass:"text-h6 text-center"},[e._v("\n                Import PNG\n              ")]),i("q-separator",{attrs:{spaced:""}}),i("div",{staticClass:"row q-gutter-md"},[i("div",{},[i("q-editor",{staticStyle:{"min-width":"200px"},attrs:{"min-height":"200px",placeholder:"Paste the PNG picture here",toolbar:[]},model:{value:e.pictureEditorContent,callback:function(t){e.pictureEditorContent=t},expression:"pictureEditorContent"}})],1)])],1):e._e(),e.pictureImportPanel?i("q-separator",{attrs:{vertical:""}}):e._e(),e.pictureImportPanel?i("div",{staticClass:"column",staticStyle:{"max-height":"300px"}},[i("div",{staticClass:"text-h6 text-center"},[e._v("\n                Detected / Extracted\n              ")]),i("q-separator",{attrs:{spaced:""}}),i("div",{staticClass:"row q-gutter-md"},[i("div",{staticClass:"text-center",staticStyle:{"min-width":"70px"}},[i("div",[e._v("70x70")]),i("IconPicture",{attrs:{pngBase64:e.pictureEditorContentPngBase64Extracted,size:70}})],1),i("div",{staticClass:"text-center",staticStyle:{"min-width":"150px"}},[i("div",[e._v("150x150")]),i("IconPicture",{attrs:{pngBase64:e.pictureEditorContentPngBase64Extracted,size:150}})],1)]),e.pictureImportPictureFound?e._e():i("div",{staticClass:"q-mt-xl text-negative"},[i("q-icon",{attrs:{name:"image_not_supported"}}),e._v("\n                No picture found in content\n              ")],1),e.pictureImportPictureFound&&!e.pictureImportPictureIsPng?i("div",{staticClass:"q-mt-xl text-warning"},[i("q-icon",{attrs:{name:"image_not_supported"}}),e._v("\n                The "),i("span",{staticStyle:{"text-decoration":"underline"}},[e._v("first")]),e._v(" picture is not in a PNG.\n              ")],1):e._e(),i("q-space"),i("q-btn",{staticClass:"self-end full-width",attrs:{disabled:!(e.pictureEditorContentPngBase64Extracted&&e.pictureEditorContentPngBase64Extracted.length&&(!e.pictureEditorContentPngBase64ExtractedAccepted||!e.pictureEditorContentPngBase64ExtractedAccepted.length)),color:"primary",icon:"check_circle_outline"},on:{click:function(t){return e.acceptPictureEditorContentPngBase64()}}},[e._v("\n                Accept\n              ")])],1):e._e(),e.pictureEditorContentPngBase64ExtractedAccepted&&e.pictureEditorContentPngBase64ExtractedAccepted.length?i("q-separator",{attrs:{vertical:""}}):e._e(),e.pictureEditorContentPngBase64ExtractedAccepted&&e.pictureEditorContentPngBase64ExtractedAccepted.length?i("div",{staticClass:"column",staticStyle:{"max-height":"300px"}},[i("div",{staticClass:"text-h6 text-center"},[e._v("\n                New\n              ")]),i("q-separator",{attrs:{spaced:""}}),i("div",{staticClass:"row q-gutter-md"},[i("div",{staticClass:"text-center",staticStyle:{"min-width":"70px"}},[i("div",[e._v("70x70")]),i("IconPicture",{attrs:{pngBase64:e.pictureEditorContentPngBase64ExtractedAccepted,size:70}})],1),i("div",{staticClass:"text-center",staticStyle:{"min-width":"150px"}},[i("div",[e._v("150x150")]),i("IconPicture",{attrs:{pngBase64:e.pictureEditorContentPngBase64ExtractedAccepted,size:150}})],1)]),i("q-space"),i("q-btn",{staticClass:"self-end full-width",attrs:{color:"negative",icon:"close"},on:{click:function(t){return e.discardAcceptedPictureEditorContentPngBase64()}}},[e._v("\n                Discard\n              ")])],1):e._e(),e.pipelineTemplateIconPictureToBeDeleted?i("q-separator",{attrs:{vertical:""}}):e._e(),e.pipelineTemplateIconPictureToBeDeleted?i("div",{staticClass:"column",staticStyle:{"max-height":"300px"}},[i("div",{staticClass:"text-h6 text-center text-negative"},[e._v("\n                To be deleted at next save.\n              ")]),i("q-space"),i("q-btn",{staticClass:"self-end full-width",attrs:{color:"positive",icon:"undo"},on:{click:function(t){return e.discardIconPictureToBeDeleted()}}},[e._v("\n                Undo\n              ")])],1):e._e()],1)],1),i("q-separator",{attrs:{vertical:""}}),i("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[i("q-btn",{attrs:{icon:"edit",color:"primary"},on:{click:function(t){e.pictureImportPanel=!0}}},[i("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[e._v("\n                Update the picture\n              ")])],1),i("q-btn",{attrs:{icon:"delete",loading:e.dataLoading}},[i("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[e._v("\n                Remove the picture\n              ")]),i("q-menu",{attrs:{"content-class":"bg-negative text-white",anchor:"top end",self:"top start"}},[i("q-list",[i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.removePicture()}}},[i("q-item-section",[e._v("Confirm")])],1)],1)],1)],1)],1)],1)],1),i("q-card",{staticClass:"q-pa-md q-mx-none"},[i("q-card-section",{attrs:{horizontal:""}},[i("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[i("q-card-section",{staticClass:"text-h4 row"},[e._v("\n              Readme\n            "),i("q-space"),e.readmeNeedsSaving?i("q-icon",{attrs:{name:"save_as",color:"positive"}},[i("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[e._v("\n                Needs saving\n              ")])],1):e._e()],1),i("q-card-section",[i("q-editor",{attrs:{"min-height":"20rem",dense:e.$q.screen.lt.md,toolbar:[["bold","italic","strike"],[{label:e.$q.lang.editor.formatting,icon:e.$q.iconSet.editor.formatting,list:"no-icons",options:["h1","h2","h3","h4","h5","h6","p","code"]},"removeFormat"],[{label:e.$q.lang.editor.align,icon:e.$q.iconSet.editor.align,fixedLabel:!0,options:["left","center","right","justify"]}],["hr","link"],["quote","unordered","ordered","outdent","indent"],["print","fullscreen"],["undo","redo"]]},model:{value:e.readmeContentEditor,callback:function(t){e.readmeContentEditor=t},expression:"readmeContentEditor"}})],1)],1),i("q-separator",{attrs:{vertical:""}}),i("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[i("q-btn",{attrs:{icon:"delete",loading:e.dataLoading}},[i("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[e._v("\n                Remove Readme content\n              ")]),i("q-menu",{attrs:{"content-class":"bg-negative text-white",anchor:"top end",self:"top start"}},[i("q-list",[i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){return e.removeReadme()}}},[i("q-item-section",[e._v("Confirm")])],1)],1)],1)],1)],1)],1)],1)],1)],1)},n=[],r=(i("e9c4"),i("2f62")),s=i("a87d"),c=i("da35"),o=i("2675"),l=i("7c4c"),p=i("541d"),d=i("7c5c"),m=i("4dc6");l["a"].addDefaultLocale(p);const u=new m["NodeHtmlMarkdown"]({keepDataImages:!0},void 0,void 0);var h={name:"PageAdminPipelineTemplateReview",mixins:[s["a"]],components:{Identicon:c["a"],IconPicture:o["a"]},data(){return{pipelineTemplateUid:"",pipelineTemplate:{},pipelineTemplateLoading:!1,pictureEditorContent:"",pictureEditorContentPngBase64Extracted:"",pictureEditorContentPngBase64ExtractedAccepted:"",pipelineTemplateIconPictureToBeDeleted:!1,pictureImportPanel:!1,pictureImportPictureFound:!1,pictureImportPictureIsPng:!1,readmeContentHtml:"",readmeContentEditor:""}},computed:{...Object(r["d"])("mainStore",["ezMarketStatuses","ezMarketPublishers"]),dataLoading(){return this.pipelineTemplateLoading},needsSaving(){return this.pictureNeedsSaving||this.readmeNeedsSaving},pictureNeedsSaving(){return!!(this.pictureEditorContentPngBase64ExtractedAccepted&&this.pictureEditorContentPngBase64ExtractedAccepted.length||!0===this.pipelineTemplateIconPictureToBeDeleted)},readmeNeedsSaving(){return!(this.readmeContentEditor===this.readmeContentHtml)},pipelineTemplateName(){return this.pipelineTemplate.pipelineTemplateName},publishersOptions(){const e=[];return this.ezMarketPublishers&&Array.isArray(this.ezMarketPublishers)&&this.ezMarketPublishers.length&&this.ezMarketPublishers.forEach((t=>{e.push({value:t.publisherUid,label:t.displayName})})),e},readmeContentEditorAsMarkdown(){if(this.readmeNeedsSaving)try{const e=u.translate(this.readmeContentEditor);return e}catch{}return this.pipelineTemplate.pipelineTemplateReadmeMarkdown}},methods:{...Object(r["b"])("mainStore",["getStatuses","getPublishers","getPipelineTemplateByUid","updatePipelineTemplate"]),loadStatuses(){this.getStatuses({loadingVariableName:"statusesLoading",caller:this})},loadPublishers(){this.getPublishers({loadingVariableName:"publishersLoading",caller:this})},loadPipelineTemplate(){this.getPipelineTemplateByUid({pipelineTemplateUid:this.pipelineTemplateUid,loadingVariableName:"pipelineTemplateLoading",caller:this,onSuccessCallBack:this.pipelineTemplateLoaded})},pipelineTemplateLoaded(e){if(e&&e.data&&e.data.records&&Array.isArray(e.data.records)&&e.data.records.length>=0)try{const i=JSON.parse(JSON.stringify(e.data.records[0]));if(i)try{i.pipelineTemplateStats=JSON.parse(i.pipelineTemplateStats)||{}}catch(t){i.pipelineTemplateStats={}}this.pipelineTemplate=i}catch(t){this.pipelineTemplate={}}finally{this.discardAcceptedPictureEditorContentPngBase64(),this.pipelineTemplateIconPictureToBeDeleted=!1,this.discardEditedReadmeContent()}},save(){this.pipelineTemplateUid&&this.pipelineTemplateUid.length&&this.pipelineTemplate&&this.pipelineTemplate.pipelineTemplateUid&&this.pipelineTemplate.pipelineTemplateUid.length&&this.pipelineTemplateUid===this.pipelineTemplate.pipelineTemplateUid&&this.updatePipelineTemplate({pipelineTemplateUid:this.pipelineTemplateUid,statusId:this.pipelineTemplate.statusId,name:this.pipelineTemplate.pipelineTemplateName,pipelineTemplateIconPicture:this.pictureEditorContentPngBase64ExtractedAccepted&&this.pictureEditorContentPngBase64ExtractedAccepted.length?this.pictureEditorContentPngBase64ExtractedAccepted:!0===this.pipelineTemplateIconPictureToBeDeleted?null:void 0,pipelineTemplateReadmeMarkdown:this.readmeNeedsSaving?this.readmeContentEditorAsMarkdown:void 0,loadingVariableName:"pipelineTemplateLoading",caller:this,onSuccessCallBack:this.loadPipelineTemplate,onErrorCallBack:this.updatePipelineTemplateFailure,debug:!0})},reverseToLastSaved(){this.loadPipelineTemplate()},updatePipelineTemplateFailure(e){this.$root.$emit("addAndShowErrorToErrorPanel",e),this.loadPipelineTemplate()},extractPictureEditorContentPngBase64(e){try{const t=e||"",i=t.match(/<img .*?src="([^"]*)"/);if(i&&Array.isArray(i)&&i.length>=2)return this.pictureImportPictureFound=!0,void this.loadImageFromUrl(i&&Array.isArray(i)&&i.length>=2?i[1]:"");this.pictureImportPictureFound=!1,this.pictureImportPictureIsPng=!1,this.pictureEditorContentPngBase64Extracted=""}catch(t){this.pictureImportPictureFound=!1,this.pictureImportPictureIsPng=!1,this.pictureEditorContentPngBase64Extracted=""}return""},async loadImageFromUrl(e){if(e&&e.length)try{const t=await fetch(e),i=await t.blob(),a=new FileReader;a.readAsDataURL(i),a.onloadend=()=>{const e=a.result,t=e.match(/data:image\/png;base64,(.*)/);t&&Array.isArray(t)&&t.length>=2?(this.pictureEditorContentPngBase64Extracted=t&&Array.isArray(t)&&t.length>=2?t[1]:"",this.pictureImportPictureIsPng=!0):(this.pictureImportPictureIsPng=!1,this.pictureEditorContentPngBase64Extracted="")}}catch(t){this.pictureImportPictureIsPng=!1,this.pictureEditorContentPngBase64Extracted=""}},acceptPictureEditorContentPngBase64(){this.pictureEditorContentPngBase64ExtractedAccepted=this.pictureEditorContentPngBase64Extracted,this.discardIconPictureToBeDeleted()},discardAcceptedPictureEditorContentPngBase64(){this.pictureEditorContentPngBase64ExtractedAccepted=""},removePicture(){this.pipelineTemplateIconPictureToBeDeleted=!0,this.discardAcceptedPictureEditorContentPngBase64()},discardIconPictureToBeDeleted(){this.pipelineTemplateIconPictureToBeDeleted=!1},removeReadme(){this.readmeContentEditor=""},discardEditedReadmeContent(){try{this.readmeContentHtml=d["marked"].parse(this.pipelineTemplate.pipelineTemplateReadmeMarkdown)}catch(e){}finally{this.readmeContentEditor=this.readmeContentHtml}}},mounted(){this.$route.params.pipelineTemplateUid&&this.$route.params.pipelineTemplateUid.length&&this.pipelineTemplateUid!==this.$route.params.pipelineTemplateUid&&(this.pipelineTemplateUid=this.$route.params.pipelineTemplateUid),this.loadStatuses(),this.loadPublishers(),this.loadPipelineTemplate()},watch:{pictureEditorContent:{handler(e){this.extractPictureEditorContentPngBase64(e)}}}},g=h,v=i("2877"),P=i("9989"),C=i("e359"),q=i("b498"),T=i("65c6"),x=i("9c40"),E=i("eb85"),b=i("6ac5"),f=i("f09f"),_=i("a370"),B=i("2c91"),I=i("0016"),y=i("05c0"),S=i("d66b"),k=i("4b7e"),w=i("4e73"),A=i("1c1c"),N=i("66e5"),U=i("4074"),z=i("7f67"),L=i("eebe"),M=i.n(L),Q=Object(v["a"])(g,a,n,!1,null,null,null);t["default"]=Q.exports;M()(Q,"components",{QPage:P["a"],QHeader:C["a"],QColor:q["a"],QToolbar:T["a"],QBtn:x["a"],QSeparator:E["a"],QToolbarTitle:b["a"],QCard:f["a"],QCardSection:_["a"],QSpace:B["a"],QIcon:I["a"],QTooltip:y["a"],QEditor:S["a"],QCardActions:k["a"],QMenu:w["a"],QList:A["a"],QItem:N["a"],QItemSection:U["a"]}),M()(Q,"directives",{ClosePopup:z["a"]})}}]);