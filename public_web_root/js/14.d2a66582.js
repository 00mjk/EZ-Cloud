(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{ae86:function(s,e,t){"use strict";t.r(e);var n=function(){var s=this,e=s._self._c;return e("q-page",{staticClass:"q-pa-sm"},[e("q-header",{class:s.darkMode?"":"bg-grey-1",style:s.darkMode?"background: var(--q-color-dark);":"",attrs:{elevated:""}},[e("q-toolbar",{staticClass:"q-gutter-x-sm",class:s.darkMode?"":"text-black"},[e("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"arrow_back",label:s.$t("Return to Admin"),to:"/Admin"}}),e("q-separator",{attrs:{spaced:"",vertical:""}}),e("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"link",color:"primary",label:s.$t("Manage MS SQL Connection"),to:"/Admin/SIEM/MsSql"}}),e("q-toolbar-title",{staticClass:"text-center",staticStyle:{opacity:".4"}},[s._v(s._s(s.$t("Admin : SIEM : Update Database")))])],1)],1),e("div",{staticClass:"q-gutter-y-sm"},[e("q-card",{},[e("q-card-section",{attrs:{horizontal:""}},[e("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[e("q-card-section",{staticClass:"text-h4"},[s._v("\n              "+s._s(s.$t("Database Version Details"))+"\n          ")]),s.managedOnBackend?e("div",[e("q-card-section",{staticClass:"q-pt-none"},[s._v("\n              "+s._s(s.$t("The MS SQL connection configuration is managed on the Backend."))+"\n            ")]),e("q-card-section",{staticClass:"q-pt-none"},[s._v("\n              "+s._s(s.$t("Nothing to do here."))+"\n            ")])],1):e("div",[e("q-card-section",{staticClass:"q-pt-none"},[e("q-list",{attrs:{dense:"",bordered:"",separator:""}},[e("q-item",[e("q-item-section",{attrs:{avatar:""}},[s.loadingEmdbVersions?e("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):s.siemEmdbVersions&&!1===s.siemEmdbVersions.sqlServerIsUp?e("q-icon",{attrs:{name:"o_block",size:"sm",color:"warning"}}):s.siemEmdbVersions&&s.siemEmdbVersions.sqlServerIsUp?e("q-icon",{attrs:{name:"o_task_alt",size:"sm",color:"positive"}}):e("q-icon",{attrs:{name:"o_block",size:"sm",color:"grey"}})],1),e("q-item-section",[e("q-item-label",[s._v(s._s(s.$t("MS SQL Server")))]),e("q-item-label",{staticClass:"q-pl-md",attrs:{caption:""}},[s._v("\n                      "+s._s(s.$t("Status: {siemEmdbVersionsSqlServerIsUp}",{siemEmdbVersionsSqlServerIsUp:s.siemEmdbVersions&&s.siemEmdbVersions.sqlServerIsUp?s.$t("Up and running"):!1===s.siemEmdbVersions.sqlServerIsUp?s.$t("Unreachable"):s.$t("Unknown")}))),e("br"),s._v("\n                      "+s._s(s.$t("Version: {siemEmdbVersionsSqlServerVersion}",{siemEmdbVersionsSqlServerVersion:s.siemEmdbVersions&&s.siemEmdbVersions.sqlServerVersion?s.siemEmdbVersions.sqlServerVersion:""}))+"\n                    ")])],1)],1),e("q-item",[e("q-item-section",{attrs:{avatar:""}},[s.loadingEmdbVersions?e("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):s.siemEmdbVersions&&!1===s.siemEmdbVersions.ezDatabaseExists?e("q-icon",{attrs:{name:"o_block",size:"sm",color:"warning"}}):s.siemEmdbVersions&&s.siemEmdbVersions.ezDatabaseExists?e("q-icon",{attrs:{name:"o_task_alt",size:"sm",color:"positive"}}):e("q-icon",{attrs:{name:"o_block",size:"sm",color:"grey"}})],1),e("q-item-section",[e("q-item-label",[s._v(s._s(s.$t("EZ Database")))]),e("q-item-label",{staticClass:"q-pl-md",attrs:{caption:""}},[s._v("\n                      "+s._s(s.$t("Presence: {siemEmdbVersionsEzDatabaseExists}",{siemEmdbVersionsEzDatabaseExists:s.siemEmdbVersions&&s.siemEmdbVersions.ezDatabaseExists?s.$t("Present"):!1===s.siemEmdbVersions.ezDatabaseExists?s.$t("Not found"):s.$t("Unknown")}))),e("br"),s._v("\n                      "+s._s(s.$t("Status: {siemEmdbVersionsEzDatabaseStatusStatus}",{siemEmdbVersionsEzDatabaseStatusStatus:s.siemEmdbVersions&&s.siemEmdbVersions.ezDatabaseStatus?s.siemEmdbVersions.ezDatabaseStatus.status:""}))),e("br"),s._v("\n                      "+s._s(s.$t("Created on: {siemEmdbVersionsEzDatabaseStatusCreatedOn}",{siemEmdbVersionsEzDatabaseStatusCreatedOn:s.siemEmdbVersions&&s.siemEmdbVersions.ezDatabaseStatus?s.siemEmdbVersions.ezDatabaseStatus.createdOn:""}))+"\n                    ")])],1)],1),e("q-item",[e("q-item-section",{attrs:{avatar:""}},[s.loadingEmdbVersions?e("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):s.siemEmdbVersions&&!1===s.siemEmdbVersions.viewGet_EZ_VersionsExists?e("q-icon",{attrs:{name:"o_block",size:"sm",color:"warning"}}):s.siemEmdbVersions&&s.siemEmdbVersions.viewGet_EZ_VersionsExists?e("q-icon",{attrs:{name:"o_task_alt",size:"sm",color:"positive"}}):e("q-icon",{attrs:{name:"o_block",size:"sm",color:"grey"}})],1),e("q-item-section",[e("q-item-label",[s._v(s._s(s.$t("EZ Versions View")))]),e("q-item-label",{staticClass:"q-pl-md",attrs:{caption:""}},[s._v("\n                      "+s._s(s.$t("Presence: {siemEmdbVersionsViewGet_EZ_VersionsExists}",{siemEmdbVersionsViewGet_EZ_VersionsExists:s.siemEmdbVersions&&s.siemEmdbVersions.viewGet_EZ_VersionsExists?s.$t("Present"):!1===s.siemEmdbVersions.viewGet_EZ_VersionsExists?s.$t("Not found"):s.$t("Unknown")}))),e("br"),s._v("\n                      "+s._s(s.$t("Created on: {siemEmdbVersionsViewGet_EZ_VersionsExistsCreatedOn}",{siemEmdbVersionsViewGet_EZ_VersionsExistsCreatedOn:s.siemEmdbVersions&&s.siemEmdbVersions.viewGet_EZ_VersionsDetails?s.siemEmdbVersions.viewGet_EZ_VersionsDetails.createdOn:""}))),e("br"),s._v("\n                      "+s._s(s.$t("Updated on: {siemEmdbVersionsViewGet_EZ_VersionsExistsUpdatedOn}",{siemEmdbVersionsViewGet_EZ_VersionsExistsUpdatedOn:s.siemEmdbVersions&&s.siemEmdbVersions.viewGet_EZ_VersionsDetails?s.siemEmdbVersions.viewGet_EZ_VersionsDetails.updatedOn:""}))+"\n                    ")])],1)],1),s._l(s.databaseElementsWithVersion,(function(t,n){return e("q-item",{key:n},[e("q-item-section",{attrs:{avatar:""}},[s.loadingEmdbVersions?e("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):t.requiredVersion<=t.detectedVersion?e("q-icon",{attrs:{name:"o_task_alt",size:"sm",color:"positive"}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                        "+s._s(s.$t("Up to date"))+"\n                      ")])],1):t.requiredVersion>t.detectedVersion?e("q-icon",{attrs:{name:"o_upgrade",size:"sm",color:"warning"}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                        "+s._s(s.$t("Needs upgrading"))+"\n                      ")])],1):t.detectedVersion?e("q-icon",{attrs:{name:"o_block",size:"sm",color:"grey"}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                        "+s._s(s.$t("Unknown or not needed"))+"\n                      ")])],1):e("q-icon",{attrs:{name:"o_upgrade",size:"sm",color:"warning"}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                        "+s._s(s.$t("Needs upgrading"))+"\n                      ")])],1)],1),e("q-item-section",[e("q-item-label",[s._v(s._s(s.$t("EZ Database component: {storedProcedureAndViewsVersionName}",{storedProcedureAndViewsVersionName:t.name})))]),e("q-item-label",{staticClass:"q-pl-md",attrs:{caption:""}},[s._v("\n                      "+s._s(s.$t("Required Version: {storedProcedureAndViewsVersionRequiredVersion}",{storedProcedureAndViewsVersionRequiredVersion:t.requiredVersion}))),e("br"),s._v("\n                      "+s._s(s.$t("Detected Version: {storedProcedureAndViewsVersionDetectedVersion}",{storedProcedureAndViewsVersionDetectedVersion:t.detectedVersion?t.detectedVersion:s.$t("Missing or unknown")}))),e("br")])],1)],1)}))],2)],1)],1)],1),e("q-separator",{attrs:{vertical:""}}),e("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[e("q-btn",{attrs:{icon:"refresh",color:"primary",loading:s.loadingEmdbVersions,disabled:s.loadingEmdbVersions},on:{click:function(e){return s.loadEmdbVersions()}}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                "+s._s(s.$t("Reload Database Version Details"))+"\n              ")])],1)],1)],1)],1),e("q-card",{},[e("q-card-section",{attrs:{horizontal:""}},[e("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[e("q-card-section",{staticClass:"text-h4"},[s._v("\n              "+s._s(s.$t("Update Database"))+"\n          ")]),e("q-card-section",{staticClass:"q-pt-none"},[e("span",{staticClass:"text-bold"},[s._v(s._s(s.$t("Why?")))]),e("br"),s._v("\n            "+s._s(s.$t("New versions of OC-Admin sometimes require to update some parts of the SIEM database."))),e("br")]),e("q-card-section",{staticClass:"q-pt-none"},[e("span",{staticClass:"text-bold"},[s._v(s._s(s.$t("How?")))]),e("br"),s._v("\n            "+s._s(s.$t("To accomplish this, it needs to know SQL credentials with enough access to alter the SIEM database."))),e("br"),s._v("\n            "+s._s(s.$t('These credentials are different from the ones configured and saved in the "Manage MS SQL Connection" administration page: they will be used once, but never saved.'))+"\n          ")]),e("q-card-section",{staticClass:"q-pt-none"},[e("span",{staticClass:"text-bold"},[s._v(s._s(s.$t("What will be updated?")))]),e("br"),s._v("\n            "+s._s(s.$t("It will update, or create if not already present, in the Database the Views and Stored Procedures necessary for OC-Admin to view SIEM Log Sources, License and Hosts, as well as handle (create/update) Log Source Types, Log Sources, Log Source Virtualisation and MPE Rules (Regex)."))+"\n          ")]),s.managedOnBackend?e("div",[e("q-card-section",{staticClass:"q-pt-none"},[s._v("\n              "+s._s(s.$t("The MS SQL connection configuration is managed on the Backend."))+"\n            ")]),e("q-card-section",{staticClass:"q-pt-none"},[s._v("\n              "+s._s(s.$t("Nothing to do here."))+"\n            ")])],1):e("div",[e("q-card-section",{staticClass:"q-pt-none"},[e("q-input",{attrs:{dense:"",outlined:"",disable:s.loadingMsSqlConfig,label:s.$t("Username"),rules:[e=>!!e||s.$t("Username cannot be empty")]},model:{value:s.siemMsSqlUsername,callback:function(e){s.siemMsSqlUsername=e},expression:"siemMsSqlUsername"}})],1),e("q-card-section",{staticClass:"q-pt-none"},[e("q-input",{attrs:{dense:"",outlined:"",disable:s.loadingMsSqlConfig,type:"password",label:s.$t("Password"),rules:[e=>!!e||s.$t("Really?! An empty Password?")]},model:{value:s.siemMsSqlPassword,callback:function(e){s.siemMsSqlPassword=e},expression:"siemMsSqlPassword"}})],1)],1)],1),e("q-separator",{attrs:{vertical:""}}),e("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[e("q-btn",{attrs:{icon:"update",color:"primary",loading:s.updatingAction,disabled:!s.readyToUpdate},on:{click:function(e){return s.promptToUpdateEmdb()}}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                "+s._s(s.$t("Connect to and update Database"))+"\n              ")])],1)],1)],1)],1),e("q-card",{},[e("q-card-section",{attrs:{horizontal:""}},[e("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[e("q-card-section",{staticClass:"text-h4"},[s._v("\n              "+s._s(s.$t("MS SQL Connection"))+"\n          ")]),e("q-card-section",{staticClass:"q-pt-none"},[s._v("\n              "+s._s(s.$t('This update will use the other connection details already configured in "Manage MS SQL Connection". As shown below:'))+"\n          ")]),s.managedOnBackend?e("div",[e("q-card-section",{staticClass:"q-pt-none"},[s._v("\n              "+s._s(s.$t("The MS SQL connection configuration is managed on the Backend."))+"\n            ")]),e("q-card-section",{staticClass:"q-pt-none"},[s._v("\n              "+s._s(s.$t("Nothing to do here."))+"\n            ")])],1):e("div",[e("q-card-section",{staticClass:"q-pt-none"},[e("q-input",{attrs:{dense:"",outlined:"",disable:"",label:s.$t("Hostname (XM or Platform Manager)"),autofocus:"",rules:[e=>!!e||s.$t("Hostname cannot be empty")]},model:{value:s.siemMsSqlHost,callback:function(e){s.siemMsSqlHost=e},expression:"siemMsSqlHost"}})],1),e("q-card-section",{staticClass:"q-pt-none"},[e("q-input",{attrs:{dense:"",outlined:"",disable:"",label:s.$t("MS SQL Port"),type:"number",rules:[e=>null!==e&&""!==e||s.$t("Port must be specified"),s=>s>=1&&s<=65535||"Port should be between 1 and 65535. Standard MS SQL port is 1433."]},model:{value:s.siemMsSqlPort,callback:function(e){s.siemMsSqlPort=e},expression:"siemMsSqlPort"}})],1),e("q-card-section",{staticClass:"q-pt-none q-mb-md"},[e("q-toggle",{attrs:{disable:"",label:s.$t("Encrypt traffic"),"left-label":"","checked-icon":"lock","unchecked-icon":"warning",color:!0===s.siemMsSqlEncrypt?"positive":"warning","keep-color":"",size:"4rem"},model:{value:s.siemMsSqlEncrypt,callback:function(e){s.siemMsSqlEncrypt=e},expression:"siemMsSqlEncrypt"}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[s._v("\n                  "+s._s(s.$t("Enable encryption between OC-Admin backend and MS SQL on the XM or Platform Manager (PM)"))+"\n                ")])],1)],1)],1)],1),e("q-separator",{attrs:{vertical:""}}),e("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[e("q-btn",{attrs:{icon:"refresh",loading:s.loadingMsSqlConfig},on:{click:function(e){return s.loadMsSqlConfig()}}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                "+s._s(s.$t("Reload MS SQL Connection settings"))+"\n              ")])],1),e("q-btn",{attrs:{icon:"edit",loading:s.updatingAction,to:"/Admin/SIEM/MsSql"}},[e("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[s._v("\n                "+s._s(s.$t("Edit MS SQL Connection setting"))+"\n              ")])],1)],1)],1)],1)],1)],1)},i=[],a=t("2f62"),o=t("a87d"),r=t("afd9"),d={name:"PageAdminSiemUpdateEmdb",mixins:[o["a"]],data(){return{loadingEmdbVersions:!1,loadingMsSqlConfig:!1,updatingAction:!1,siemMsSqlHost:null,siemMsSqlPort:1433,siemMsSqlEncrypt:!0,siemMsSqlUsername:null,siemMsSqlPassword:null}},computed:{...Object(a["d"])("mainStore",["siemEmdbVersions","msSqlConfig","extraInformation","minimalEzDbPartsVersions"]),readyToUpdate(){return this.siemMsSqlHost&&this.siemMsSqlHost.length&&this.siemMsSqlPort>=1&&this.siemMsSqlPort<=65535&&this.siemMsSqlUsername&&this.siemMsSqlUsername.length&&!this.managedOnBackend},managedOnBackend(){return this.msSqlConfig&&!0===this.msSqlConfig.isManagedOnBackend},databaseElementsWithVersion(){const s=[];return this.minimalEzDbPartsVersions&&Array.isArray(this.minimalEzDbPartsVersions)&&this.minimalEzDbPartsVersions.forEach((e=>{s.push({name:e.name,requiredVersion:e.version,detectedVersion:((this.siemEmdbVersions&&this.siemEmdbVersions.storedProcedureAndViewsVersions&&Array.isArray(this.siemEmdbVersions.storedProcedureAndViewsVersions)?this.siemEmdbVersions.storedProcedureAndViewsVersions:[]).find((s=>String(s.name).toLowerCase()===String(e.name).toLowerCase()))||{}).version})})),s}},methods:{...Object(a["b"])("mainStore",["getEmdbVersions","getMsSqlConfig","updateEmdb","updateExtraInformation"]),promptToUpdateEmdb(){this.$q.dialog({component:r["a"],parent:this,title:this.$t("Confirm"),message:this.$t("Do you want to connect to Database and update it?"),persistent:!0}).onOk((()=>{this.doUpdateEmdb()}))},doUpdateEmdb(){this.updateEmdb({host:this.siemMsSqlHost,port:this.siemMsSqlPort,username:this.siemMsSqlUsername,password:this.siemMsSqlPassword,encrypt:this.siemMsSqlEncrypt,loadingVariableName:"updatingAction",caller:this,onSuccessCallBack:this.loadEmdbVersions,onErrorCallBack:this.updateEmdbFailure})},prepVariables(){this.msSqlConfig&&(this.siemMsSqlHost=this.msSqlConfig.host,this.siemMsSqlPort=this.msSqlConfig.port,this.siemMsSqlEncrypt=!!this.msSqlConfig.encrypt)},loadEmdbVersions(){this.getEmdbVersions({loadingVariableName:"loadingEmdbVersions",silent:!1,caller:this})},loadMsSqlConfig(){this.getMsSqlConfig({loadingVariableName:"loadingMsSqlConfig",caller:this,onSuccessCallBack:this.prepVariables})},updateEmdbFailure(s){this.$root.$emit("addAndShowErrorToErrorPanel",s)},requiredVersionForEzDbPartByName(s){if(this.minimalEzDbPartsVersions){const e=this.minimalEzDbPartsVersions.filter((e=>String(e.name).toLowerCase()===String(s).toLowerCase()));return e&&e.length?e[0].version:"Unknown"}return"Unknown"}},mounted(){this.msSqlConfig&&this.msSqlConfig.config&&this.msSqlConfig.config.server.length||this.loadMsSqlConfig(),this.siemEmdbVersions&&this.siemEmdbVersions.ezDatabaseStatus||this.loadEmdbVersions()}},l=d,m=t("2877"),c=t("9989"),b=t("e359"),q=t("b498"),p=t("65c6"),u=t("9c40"),E=t("eb85"),V=t("6ac5"),S=t("f09f"),_=t("a370"),g=t("1c1c"),h=t("66e5"),v=t("4074"),f=t("8380"),C=t("0016"),M=t("0170"),w=t("05c0"),$=t("4b7e"),k=t("27f9"),y=t("9564"),z=t("eebe"),P=t.n(z),D=Object(m["a"])(l,n,i,!1,null,null,null);e["default"]=D.exports;P()(D,"components",{QPage:c["a"],QHeader:b["a"],QColor:q["a"],QToolbar:p["a"],QBtn:u["a"],QSeparator:E["a"],QToolbarTitle:V["a"],QCard:S["a"],QCardSection:_["a"],QList:g["a"],QItem:h["a"],QItemSection:v["a"],QSpinnerDots:f["a"],QIcon:C["a"],QItemLabel:M["a"],QTooltip:w["a"],QCardActions:$["a"],QInput:k["a"],QToggle:y["a"]})}}]);