(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"02cd":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticClass:"q-pa-sm"},[o("q-header",{class:e.darkMode?"":"bg-grey-1",style:e.darkMode?"background: var(--q-color-dark);":"",attrs:{elevated:""}},[o("q-toolbar",{staticClass:"q-gutter-x-sm",class:e.darkMode?"":"text-black"},[o("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"arrow_back",label:"Return to Properties",to:"/Pipelines/"+this.pipelineUid+"/Properties"}}),o("q-separator",{attrs:{vertical:""}}),o("q-toolbar-title",{staticClass:"text-center",staticStyle:{opacity:".4"}},[e._v("Edit Deployment"),e.pipeline&&e.pipeline.name&&e.pipeline.name.length?o("span",[e._v(":  "+e._s(e.pipeline.name))]):e._e()])],1)],1),o("div",{staticClass:" q-gutter-y-sm"},[o("q-card",[o("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[o("q-card-section",{staticClass:"text-h4"},[e._v("\n            Select a Suitable Open Collector\n        ")]),o("q-card-section",[o("q-table",{attrs:{data:e.tableData,columns:e.columns,"row-key":"uid",dense:"","no-data-label":"No Open Collector to display.",filter:e.searchFilter,loading:e.dataLoading||e.collectorLogSourcesLoading,"rows-per-page-label":"Open Collectors per page:",pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[o("div",{staticClass:"full-width row wrap justify-between"},[o("div",{staticClass:"q-table__title"},[e._v("\n                  Available Open Collectors\n                ")]),o("div",{staticClass:"row q-gutter-md"},[o("div",{staticStyle:{width:"300px"}},[o("q-input",{attrs:{outlined:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[e.searchFilter.length?o("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){e.searchFilter=""}}}):e._e(),o("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.searchFilter,callback:function(t){e.searchFilter=t},expression:"searchFilter"}})],1),o("q-btn",{attrs:{dense:"",outline:"",icon:"refresh",loading:e.dataLoading},on:{click:function(t){return e.loadOpenCollectorsPipelinesAndLogSources()}}},[o("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                      Reload the list of Pipelines.\n                    ")])],1)],1)])]},proxy:!0},{key:"body-cell-actions",fn:function(t){return[o("q-td",{attrs:{props:t}},[!t.row.deploymentStatus||!0!==t.row.deploymentStatus.ongoing&&!0!==t.row.deploymentStatus.completed?o("q-btn",{attrs:{flat:"",dense:"",icon:"add_circle_outline",disable:!t.row.suitable||!0===t.row.alreadyDeployed},on:{click:function(o){return e.selectOpenCollectorForDeployment(t.row)}}},[o("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                    "+e._s(e.$t("Deploy"))+"\n                  ")])],1):o("q-btn",{attrs:{flat:"",dense:""}},[o("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[o("div",[o("div",{staticClass:"row justify-between q-my-sm q-mr-sm"},[o("div",{staticClass:"row items-center q-gutter-x-sm"},[o("q-icon",{attrs:{name:"list",color:"blue-3",size:"md"}}),o("div",{staticClass:"text-h6"},[e._v("Deployment Steps")])],1),o("div",{staticClass:"q-gutter-x-md"},[t.row&&t.row.deploymentStatus&&!0===t.row.deploymentStatus.error?o("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}):t.row&&t.row.deploymentStatus&&!0===t.row.deploymentStatus.completed?o("q-icon",{attrs:{name:"task_alt",color:"positive",size:"md"}}):e._e(),o("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(t.row,"deploymentStatus").done),"show-value":"","font-size":e.deploymentProgressFor(t.row,"deploymentStatus").done<100?"0.5em":"0.4em",size:"2.8em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":t.row&&t.row.deploymentStatus&&!0===t.row.deploymentStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":t.row&&t.row.deploymentStatus&&!0===t.row.deploymentStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1)]),o("q-separator"),o("div",{staticClass:"q-mb-sm"},e._l(t.row&&t.row.deploymentStatus&&t.row.deploymentStatus.steps&&t.row.deploymentStatus.steps.length?t.row.deploymentStatus.steps:[],(function(t,s){return o("q-item",{key:s,staticStyle:{"min-width":"30rem"},attrs:{dense:""}},[o("q-item-section",[o("q-item-label",[o("div",{staticClass:"row items-center no-wrap"},[o("q-icon",{class:"On-going"===t.status||"Error"===t.status?"":"invisible",attrs:{name:"arrow_right",size:"sm"}}),o("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",class:"On-going"===t.status||"Error"===t.status?"text-bold":""},[e._v(e._s(t.name))])],1)])],1),o("q-item-section",{attrs:{side:""}},["Not started"===t.status?o("q-icon",{attrs:{name:"hourglass_empty",size:"sm",color:"grey"}}):"To skip"===t.status?o("q-icon",{attrs:{name:"redo",size:"sm",color:"grey"}}):"Pending"===t.status?o("q-icon",{attrs:{name:"hourglass_top",size:"sm",color:"grey-3"}}):"On-going"===t.status?o("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):"Completed"===t.status?o("q-icon",{attrs:{name:"task_alt",size:"sm",color:"positive"}}):"Skipped"===t.status?o("q-icon",{staticStyle:{opacity:".5"},attrs:{name:"redo",size:"sm",color:"green-4"}}):"Error"===t.status?o("q-icon",{attrs:{name:"error",size:"sm",color:"orange"}}):"Cancelled"===t.status?o("q-icon",{attrs:{name:"block",size:"sm",color:"grey"}}):e._e()],1)],1)})),1),t.row&&e.deploymentProgressFor(t.row,"deploymentStatus").errorAbsolute?o("div",[o("q-separator"),o("div",{staticClass:"row items-center col no-wrap"},[o("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}),o("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),o("q-separator",{staticClass:"q-ml-none q-mr-sm",attrs:{vertical:"",color:"negative",size:"0.2rem"}}),o("div",{staticClass:"q-my-sm"},[t.row.deploymentStatus.errorMessage&&t.row.deploymentStatus.errorMessage.length?o("div",{staticClass:"text-bold text-orange"},[e._v("The last step failed with this error message:")]):o("div",{staticClass:"text-bold"},[e._v("The last step failed with no error message.")]),o("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",staticStyle:{"max-width":"35rem"}},[e._v(e._s(t.row.deploymentStatus.errorMessage))])])],1)],1):e._e(),t.row&&e.deploymentProgressFor(t.row,"deploymentStatus").skippedAbsolute?o("div",[o("q-separator"),o("div",{staticClass:"row items-center col no-wrap"},[o("q-icon",{attrs:{name:"redo",color:"green-4",size:"md"}}),o("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),o("div",{staticClass:"q-my-sm"},[e.deploymentProgressFor(t.row,"deploymentStatus").skippedAbsolute>1?o("div",{staticClass:"text-bold"},[e._v(e._s(Math.round(e.deploymentProgressFor(t.row,"deploymentStatus").skippedAbsolute))+" steps have been skipped.")]):o("div",{staticClass:"text-bold"},[e._v("One step has been skipped.")]),o("div",{},[e._v("This is fine. Steps are typically skipped if not necessary for a given deployment.")])])],1)],1):e._e()],1)]),o("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(t.row,"deploymentStatus").done),"show-value":"","font-size":e.deploymentProgressFor(t.row,"deploymentStatus").done<100?"0.5em":"0.4em",size:"1.7em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":t.row&&t.row.deploymentStatus&&!0===t.row.deploymentStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":t.row&&t.row.deploymentStatus&&!0===t.row.deploymentStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1),!t.row.unDeployStatus||!0!==t.row.unDeployStatus.ongoing&&!0!==t.row.unDeployStatus.completed?o("q-btn",{attrs:{flat:"",dense:"",icon:"remove_circle_outline",color:"negative",disable:!(!0===t.row.alreadyDeployed)},on:{click:function(o){return e.selectOpenCollectorForUndeploy(t.row)}}},[o("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[o("div",{staticClass:"text-bold q-mb-sm"},[e._v(e._s(e.$t("Un-deploy")))]),o("div",{staticClass:"q-mb-xs"},[e._v(e._s(e.$t("This Stream has already been deployed on this OpenCollector.")))]),o("div",[e._v(e._s(e.$t("This will remove the configuration from the Shipper on the OpenCollector, but will leave the OpenCollector's Pipeline and SIEM Log Source as they are.")))])])],1):o("q-btn",{attrs:{flat:"",dense:""}},[o("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[o("div",[o("div",{staticClass:"row justify-between q-my-sm q-mr-sm"},[o("div",{staticClass:"row items-center q-gutter-x-sm"},[o("q-icon",{attrs:{name:"list",color:"blue-3",size:"md"}}),o("div",{staticClass:"text-h6"},[e._v("Un-Deployment Steps")])],1),o("div",{staticClass:"q-gutter-x-md"},[t.row&&t.row.unDeployStatus&&!0===t.row.unDeployStatus.error?o("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}):t.row&&t.row.unDeployStatus&&!0===t.row.unDeployStatus.completed?o("q-icon",{attrs:{name:"task_alt",color:"positive",size:"md"}}):e._e(),o("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(t.row,"unDeployStatus").done),"show-value":"","font-size":e.deploymentProgressFor(t.row,"unDeployStatus").done<100?"0.5em":"0.4em",size:"2.8em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":t.row&&t.row.unDeployStatus&&!0===t.row.unDeployStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":t.row&&t.row.unDeployStatus&&!0===t.row.unDeployStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1)]),o("q-separator"),o("div",{staticClass:"q-mb-sm"},e._l(t.row&&t.row.unDeployStatus&&t.row.unDeployStatus.steps&&t.row.unDeployStatus.steps.length?t.row.unDeployStatus.steps:[],(function(t,s){return o("q-item",{key:s,staticStyle:{"min-width":"30rem"},attrs:{dense:""}},[o("q-item-section",[o("q-item-label",[o("div",{staticClass:"row items-center no-wrap"},[o("q-icon",{class:"On-going"===t.status||"Error"===t.status?"":"invisible",attrs:{name:"arrow_right",size:"sm"}}),o("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",class:"On-going"===t.status||"Error"===t.status?"text-bold":""},[e._v(e._s(t.name))])],1)])],1),o("q-item-section",{attrs:{side:""}},["Not started"===t.status?o("q-icon",{attrs:{name:"hourglass_empty",size:"sm",color:"grey"}}):"To skip"===t.status?o("q-icon",{attrs:{name:"redo",size:"sm",color:"grey"}}):"Pending"===t.status?o("q-icon",{attrs:{name:"hourglass_top",size:"sm",color:"grey-3"}}):"On-going"===t.status?o("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):"Completed"===t.status?o("q-icon",{attrs:{name:"task_alt",size:"sm",color:"positive"}}):"Skipped"===t.status?o("q-icon",{staticStyle:{opacity:".5"},attrs:{name:"redo",size:"sm",color:"green-4"}}):"Error"===t.status?o("q-icon",{attrs:{name:"error",size:"sm",color:"orange"}}):"Cancelled"===t.status?o("q-icon",{attrs:{name:"block",size:"sm",color:"grey"}}):e._e()],1)],1)})),1),t.row&&e.deploymentProgressFor(t.row,"unDeployStatus").errorAbsolute?o("div",[o("q-separator"),o("div",{staticClass:"row items-center col no-wrap"},[o("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}),o("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),o("q-separator",{staticClass:"q-ml-none q-mr-sm",attrs:{vertical:"",color:"negative",size:"0.2rem"}}),o("div",{staticClass:"q-my-sm"},[t.row.unDeployStatus.errorMessage&&t.row.unDeployStatus.errorMessage.length?o("div",{staticClass:"text-bold text-orange"},[e._v("The last step failed with this error message:")]):o("div",{staticClass:"text-bold"},[e._v("The last step failed with no error message.")]),o("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",staticStyle:{"max-width":"35rem"}},[e._v(e._s(t.row.unDeployStatus.errorMessage))])])],1)],1):e._e(),t.row&&e.deploymentProgressFor(t.row,"unDeployStatus").skippedAbsolute?o("div",[o("q-separator"),o("div",{staticClass:"row items-center col no-wrap"},[o("q-icon",{attrs:{name:"redo",color:"green-4",size:"md"}}),o("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),o("div",{staticClass:"q-my-sm"},[e.deploymentProgressFor(t.row,"unDeployStatus").skippedAbsolute>1?o("div",{staticClass:"text-bold"},[e._v(e._s(Math.round(e.deploymentProgressFor(t.row,"unDeployStatus").skippedAbsolute))+" steps have been skipped.")]):o("div",{staticClass:"text-bold"},[e._v("One step has been skipped.")]),o("div",{},[e._v("This is fine. Steps are typically skipped if not necessary for a given deployment.")])])],1)],1):e._e()],1)]),o("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(t.row,"unDeployStatus").done),"show-value":"","font-size":e.deploymentProgressFor(t.row,"unDeployStatus").done<100?"0.5em":"0.4em",size:"1.7em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":t.row&&t.row.unDeployStatus&&!0===t.row.unDeployStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":t.row&&t.row.unDeployStatus&&!0===t.row.unDeployStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1)],1)]}},{key:"body-cell-status",fn:function(t){return[o("q-td",{attrs:{props:t}},[!0===t.value?o("q-icon",{attrs:{name:"thumb_up",color:"green",size:"md"}}):!1===t.value?o("q-icon",{staticStyle:{opacity:".6"},attrs:{name:"thumb_down",color:"red",size:"md"}}):o("q-icon",{staticStyle:{opacity:".6"},attrs:{name:"thumb_down_off_alt",color:"orange",size:"md"}}),o("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[!0===t.value?o("span",[e._v("Suitable")]):!1===t.value?o("span",[e._v("Unsuitable")]):o("span",[e._v("Unknown. Likely unsuitable ("+e._s(t.value)+")")])])],1)]}},{key:"body-cell-installedShippers",fn:function(t){return[o("q-td",{attrs:{props:t}},[e._l(t.value,(function(t,s){return o("div",{key:s},[o("q-tooltip",{attrs:{"content-style":"font-size: 1em;"}},[e._v(e._s(t.name))]),o("q-avatar",{staticClass:"q-mr-xs",attrs:{square:"",size:"24px"}},[o("img",{attrs:{src:"/shippers/"+e.collectionShipperDetails(t.name).icon+".svg"}})]),o("q-badge",{attrs:{outline:"",color:"grey"}},[e._v("v"+e._s(t.version))])],1)})),!0!==t.row.hasNecessaryShipper?o("div",[o("q-tooltip",{attrs:{"content-style":"font-size: 1em;"}},[e._v("\n                    The necessary Shipper to collect this source is not installed on this collector."),o("br"),o("br"),e._v("\n                    Please go to the Collectors page to deploy this Shipper on this Collector."),o("br"),o("br"),o("q-icon",{staticClass:"q-mr-sm",attrs:{name:"info",size:"sm",color:"info"}}),o("span",{staticClass:"text-bold"},[e._v("Missing:")]),e._v(" "+e._s(e.pipeline&&e.pipeline.collectionConfig&&e.pipeline.collectionConfig.collectionShipper?e.pipeline.collectionConfig.collectionShipper:"N/A")),o("br"),o("img",{staticClass:"q-ml-lg",attrs:{src:"/shippers/"+e.collectionShipperDetails(e.pipeline&&e.pipeline.collectionConfig&&e.pipeline.collectionConfig.collectionShipper?e.pipeline.collectionConfig.collectionShipper:null).icon+".svg",width:"128px"}})],1),o("q-badge",{staticClass:"q-gutter-x-sm",attrs:{outline:"",color:"orange"}},[o("q-icon",{attrs:{name:"warning",size:"sm",color:"orange"}}),o("div",{staticClass:"icon-stack"},[o("img",{staticClass:"img-stack-75",attrs:{src:"/shippers/"+e.collectionShipperDetails(e.pipeline&&e.pipeline.collectionConfig&&e.pipeline.collectionConfig.collectionShipper?e.pipeline.collectionConfig.collectionShipper:null).icon+".svg"}}),o("img",{staticClass:"img-stack-100 img-stack-opacity-50",attrs:{src:"/shippers/_block_overlay.svg"}})])],1)],1):e._e()],2)]}}])})],1)],1)],1)],1),o("hr")],1)},i=[],a=(o("5319"),o("2f62")),r=o("31c4"),l=o("c1dc"),n=o("a87d"),p=o("16f1"),c={mixins:[r["a"],l["a"],n["a"],p["a"]],data(){return{pipelineUid:"",openCollectorUid:"",searchFilter:"",columns:[{name:"actions",align:"center",label:"Actions",field:"actions",sortable:!1},{name:"status",align:"center",label:"Suitable",field:"suitable",sortable:!0},{name:"openCollector",align:"center",label:"Open Collector",field:"openCollectorHost",sortable:!0},{name:"installedShippers",align:"center",label:"Installed Shippers",field:e=>e.openCollector?e.openCollector.installedShippers:void 0,sortable:!0},{name:"name",align:"center",label:"Log Source Name",field:"name",sortable:!0},{name:"msgSourceId",align:"center",label:"Log Source ID",field:"msgSourceId",sortable:!0},{name:"hostName",align:"center",label:"Log Source Host",field:"hostName",sortable:!0},{name:"hostId",align:"center",label:"Log Source Host ID",field:"hostId",sortable:!0}],pagination:{sortBy:"status",descending:!0,rowsPerPage:25},collectorLogSourcesLoading:!1,deploymentStatuses:[],unDeployStatuses:[],deploymentStepsNewLogSource:[{uid:"e745e0e6-60f6-4857-8afa-f8ea0663b6c3",name:"Create and drop Beat's configuration in right location",status:"Not started",apiEndpoint:"/oc/UpdateStreamConfigurationForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"d004f165-a028-4183-8e6d-f64534357c5d",name:"Import JQ Pipeline into Open Collector",status:"Not started",apiEndpoint:"/oc/ImportPipelineForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"b632b998-cd67-4571-a384-31faf0053d1a",name:"Create Log Source Type",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceType",apiParamNames:["uid","name"]},{uid:"7e739d98-d427-4fac-9f63-392e8ccb4c94",name:"Create MPE Rule",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateMpeRule",apiParamNames:["uid","name"]},{uid:"04ff4e8c-de73-419a-a48b-944b01bca836",name:"Create MPE Sub-Rule(s)",status:"To skip",apiEndpoint:"/logrhythmCore/UpdateMpeSubRule",apiParamNames:["uid","SubRuleUid","SubRuleName","Tag1"],specialTag:["runForEachSubRule"]},{uid:"6fba3b49-580b-4ceb-b8be-374fc848fe63",name:"Create Processing Policy",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateProcessingPolicy",apiParamNames:["uid","name","MPEPolicy_Name"]},{uid:"dd1fae83-10af-40ea-bfe9-20ff668d5141",name:"Create Log Source (LS) Virtualisation",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceVirtualisationTemplate",apiParamNames:[]},{uid:"857787cd-4ec5-4c06-b044-7aaf37de326f",name:"Create new LS Virtualisation Item and associate it to LS Virtualisation",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceVirtualisationTemplateItem",apiParamNames:["uid","name"]},{uid:"5c0a3a9c-6d01-40e6-acb8-b0763a52bba3",name:"Add LS Virtualisation to Open Collector Log Source",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateOpenCollectorLogSourceWithLogSourceVirtualisation",apiParamNames:["uid","OpenCollectorMotherLogSourceID"]}],deploymentStepsExistingLogSource:[{uid:"d1038519-da8b-4580-91a6-8c34b3001327",name:"Update Beat configuration",status:"Not started",apiEndpoint:"/oc/UpdateStreamConfigurationForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"b0f41342-c758-4453-8381-9be346f25dfe",name:"Re-import JQ Pipeline into Open Collector",status:"Not started",apiEndpoint:"/oc/ImportPipelineForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"3d0ef0a5-0c65-4b62-a68a-e1422490ffef",name:"Modify MPE Sub-Rule(s)",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateMpeSubRule",apiParamNames:["uid","SubRuleUid","SubRuleName","Tag1","Tag2","Tag3","Tag4","Tag5"]},{uid:"32d0bf3c-9e09-4388-9a68-cec7c8b38529",name:"Modify Processing Policy",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateProcessingPolicy",apiParamNames:["uid","name","MPEPolicy_Name"]},{uid:"72e265cd-9d0d-469c-b1fd-8a319f3971b2",name:"Modify Log Source Virtualisation",status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceVirtualisationTemplateItem",apiParamNames:["uid","name"]}],unDeploySteps:[{uid:"8276950b-c01b-423e-8ce0-1ed23af6efe4",name:"Delete Beat configuration for Stream",status:"Not started",apiEndpoint:"/oc/DeleteStreamConfigurationForBeat",apiParamNames:["openCollector","beat","stream"]}]}},computed:{...Object(a["d"])("mainStore",["openCollectorBeats","loggedInUser","collectionShippersOptions"]),...Object(a["c"])("mainStore",["openCollectorLogSources"]),pipeline(){const e=this.pipelines.find((e=>e.uid===this.pipelineUid));return e||{uid:"",name:"",status:"New",primaryOpenCollector:"",fieldsMapping:[],collectionConfig:{}}},deployments(){const e=[];return this.openCollectors.forEach((t=>{t.pipelines&&Array.isArray(t.pipelines)&&t.pipelines.forEach((o=>{o.uid===this.pipelineUid&&e.push({pipelineUid:o.uid,openCollector:t,enabled:o.enabled})}))})),e},tableData(){const e=[];this.openCollectorLogSources.forEach((t=>{let o=!1;this.openCollectors.forEach((s=>{if(t.hostIdentifiers&&Array.isArray(t.hostIdentifiers)&&s.hostname){const i=String(s.hostname).toLowerCase(),a=t.hostIdentifiers.filter((e=>e.value&&String(e.value).toLowerCase()===i));if(a.length){o=!0;const i=t.hostIdentifiers.reduce(((e,t)=>(t.value&&t.value.length&&e.push(t.value),e)),[]),a=this.hasNecessaryShipper(s);e.push({openCollector:s,openCollectorLogSource:t,pipelineUid:this.pipeline.uid,suitable:!!(o&a),openCollectorHost:s&&s.name&&s.hostname?s.name+" ("+s.hostname+")":null,name:t.name,msgSourceId:t.msgSourceID,hostName:t.hostName+" ("+i.join(" / ")+")",hostId:t.hostID,hasNecessaryShipper:a,deploymentStatus:this.deploymentStatuses.find((e=>e&&e.openCollectorUid&&s&&s.uid&&t&&t.msgSourceID&&e.msgSourceId===t.msgSourceID&&e.openCollectorUid===s.uid)),unDeployStatus:this.unDeployStatuses.find((e=>e&&e.openCollectorUid&&s&&s.uid&&t&&t.msgSourceID&&e.msgSourceId===t.msgSourceID&&e.openCollectorUid===s.uid)),alreadyDeployed:this.isAlreadyDeployed(s,this.pipeline.uid)})}}})),o||e.push({openCollector:null,openCollectorLogSource:t,pipelineUid:this.pipeline.uid,suitable:o,openCollectorHost:null,name:t.name,msgSourceId:t.msgSourceID,hostName:t.hostName,hostId:t.hostID,hasNecessaryShipper:!1})}));const t=e.reduce(((e,t)=>(t&&t.openCollector&&t.openCollector.uid&&t.openCollector.uid.length&&e.push(t.openCollector.uid),e)),[]);return this.openCollectors.forEach((o=>{t.includes(o.uid)||e.push({openCollector:o,openCollectorLogSource:null,pipelineUid:this.pipeline.uid,openCollectorHost:o&&o.name&&o.hostname?o.name+" ("+o.hostname+")":null,suitable:!1,hasNecessaryShipper:this.hasNecessaryShipper(o),alreadyDeployed:this.isAlreadyDeployed(o,this.pipeline.uid)})})),e},beatName(){return this.pipeline&&this.pipeline.collectionConfig&&this.pipeline.collectionConfig.collectionShipper?this.pipeline.collectionConfig.collectionShipper:""},beatConfigForStream(){const e=this.collectionShippersOptions.find((e=>e.value&&e.value===this.beatName));return this.pipeline&&this.pipeline.collectionConfig&&this.pipeline.collectionConfig.collectionShipper&&e?this.collectionConfigOutputFor(e.outputFormat,this.pipeline.collectionConfig):""}},methods:{...Object(a["b"])("mainStore",["getOpenCollectorLogSources","callDeploymentStepApi","upsertOpenCollector"]),loadOpenCollectorLogSources(){this.getOpenCollectorLogSources({loadingVariableName:"collectorLogSourcesLoading",caller:this})},loadOpenCollectorsPipelinesAndLogSources(){this.loadOpenCollectorsAndPipelines(),this.loadOpenCollectorLogSources()},selectOpenCollectorForDeployment(e){const t=!0;this.kickOffDeployment(e,this.deploymentStepsNewLogSource,this.deploymentStatuses,t)},selectOpenCollectorForUndeploy(e){const t=!1;this.kickOffDeployment(e,this.unDeploySteps,this.unDeployStatuses,t)},kickOffDeployment(e,t,o,s){if(e&&e.openCollector&&e.openCollector.uid&&e.openCollector.uid.length&&e.msgSourceId){const i=o.find((t=>t.openCollectorUid===e.openCollector.uid&&t.msgSourceId===e.msgSourceId));i?(i.ongoing=!0,i.completed=!1,i.isDeployment=s,o=JSON.parse(JSON.stringify(o))):o.push({openCollectorUid:e.openCollector.uid,msgSourceId:e.msgSourceId,ongoing:!0,completed:!1,isDeployment:s,logs:[],steps:JSON.parse(JSON.stringify(t))}),setTimeout(this.runDeploymentStep,500,this,o,e,0)}},deploymentProgressFor(e,t){const o=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.length:1,s=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.filter((e=>e.status&&e.status.length&&"completed"===e.status.toLowerCase())).length:0,i=s/o*100,a=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.filter((e=>e.status&&e.status.length&&"skipped"===e.status.toLowerCase())).length:0,r=a/o*100,l=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.filter((e=>e.status&&e.status.length&&"error"===e.status.toLowerCase())).length:0,n=l/o*100;return{done:i+r,completed:i,skipped:r,error:n,completedAbsolute:s,skippedAbsolute:a,errorAbsolute:l}},hasNecessaryShipper(e){const t=this.pipeline&&this.pipeline.collectionConfig&&this.pipeline.collectionConfig.collectionShipper&&this.pipeline.collectionConfig.collectionShipper.length?this.pipeline.collectionConfig.collectionShipper.toLowerCase():null;return!!((e&&e.installedShippers&&Array.isArray(e.installedShippers)&&e.installedShippers.filter((e=>e.name&&e.name.toLowerCase()===t)).length)|this.openCollectorBeats.filter((e=>e.value&&e.value.toLowerCase()===t)).length)},runDeploymentStep(e,t,o,s){if(o&&o.openCollector&&o.openCollector.uid&&o.openCollector.uid.length&&o.msgSourceId){const i=t.find((e=>e.openCollectorUid===o.openCollector.uid&&e.msgSourceId===o.msgSourceId));if(i&&i.steps&&i.steps.length>s){const a=i.steps[s];let r=!1;if(r|=a.status&&"To skip"===a.status,r)a.status="Skipped",setTimeout(e.runDeploymentStep,150,e,t,o,s+1);else{a.status="On-going";const r=a.apiEndpoint&&a.apiEndpoint.length?a.apiEndpoint:"/test/doesNotExist/andShouldReturnAnError",l={uid:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length?e.pipeline.uid:void 0,name:e&&e.pipeline&&e.pipeline.name&&e.pipeline.name.length?e.pipeline.name:void 0,MPEPolicy_Name:"LogRhythm Default",OpenCollectorMotherLogSourceID:i.msgSourceId,openCollector:{uid:i.openCollectorUid&&i.openCollectorUid.length?i.openCollectorUid:void 0},beat:{name:e.beatName,config:[this.beatConfigForStream]},stream:{uid:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length?e.pipeline.uid:void 0,name:e&&e.pipeline&&e.pipeline.name&&e.pipeline.name.length?e.pipeline.name:void 0,sanitisedName:e&&e.pipeline&&e.pipeline.name&&e.pipeline.name.length?e.pipeline.name.replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase():void 0,jqFilter:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length&&e.pipeline.name&&e.pipeline.name.length&&e.beatName&&e.beatName.length&&e.loggedInUser&&e.loggedInUser.length?this.buildJqFilterFromParams(e.pipeline.uid,e.pipeline.name,e.beatName,e.loggedInUser):void 0,jqTransform:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length&&e.pipeline.name&&e.pipeline.name.length&&e.beatName&&e.beatName.length&&e.loggedInUser&&e.loggedInUser.length?this.buildJqTransformFromParams(e.pipeline.uid,e.pipeline.name,e.beatName,e.loggedInUser,e.pipeline.options&&!0===e.pipeline.options.extractMessageFieldOnly,e.pipeline.fieldsMapping||[]):void 0}},n=a.apiParamNames&&a.apiParamNames.length?a.apiParamNames.reduce(((e,t)=>(e[t]=l&&l[t]?l[t]:void 0,e)),{}):void 0;e.callDeploymentStepApi({apiUrl:r,caller:e,apiCallParams:n,dataLabel:`Step name: ${a.name}`,onSuccessCallBack:(i,r=a,l=o,n=s,p=e,c=t)=>{setTimeout((()=>{r.status="Completed",p.runDeploymentStep(p,c,l,n+1)}),100+Math.floor(600*Math.random()))},onErrorCallBack:(e,t=a,o=i)=>{t.status="Error",o.ongoing=!1,o.completed=!0,o.error=!0,o.errorMessage=e&&e.messageForLogAndPopup?e.messageForLogAndPopup:"",o.errorMessage+=e&&e.captionForLogAndPopup?` // ${e.captionForLogAndPopup}`:"",o&&o.steps&&Array.isArray(o.steps)&&o.steps.filter((e=>e.status&&("not started"===e.status.toLowerCase()||"to skip"===e.status.toLowerCase()))).forEach((e=>{e.status="Cancelled"}))},debug:!1})}}else i.ongoing=!1,i.completed=!0,console.log("🏁 We have run out of Steps. Job done."),!0===i.completed&&!0!==i.error&&(console.log("💾 Saving Deployment."),setTimeout((()=>{e.updateAndPersistDeployment(o,i.isDeployment)}),100+Math.floor(250*Math.random())))}},updateAndPersistDeployment(e,t=!0){if(e&&e.openCollector&&e.openCollector.uid&&e.openCollector.uid.length&&e.pipelineUid&&e.pipelineUid.length){const o=JSON.parse(JSON.stringify(this.openCollectors.find((t=>t.uid===e.openCollector.uid))));if(o&&o.uid&&o.uid.length){o.pipelines||(o.pipelines=[]);let s=!1;o.pipelines.filter((t=>t.uid===e.pipelineUid)).forEach((e=>{e.enabled=t,s=!0})),s||o.pipelines.push({enabled:t,uid:e.pipelineUid}),this.upsertOpenCollector({openCollector:o,pushToApi:!0,caller:this})}}},isAlreadyDeployed(e,t){return!!(e&&e.pipelines&&Array.isArray(e.pipelines)&&t&&t.length)&&!!(e.pipelines.filter((e=>!0===e.enabled&&e.uid===t)).length>0)}},mounted(){0===this.openCollectorLogSources.length&&this.loadOpenCollectorLogSources(),this.$route.params.pipelineUid&&this.$route.params.pipelineUid.length&&this.pipelineUid!==this.$route.params.pipelineUid&&(this.pipelineUid=this.$route.params.pipelineUid),this.$route.params.openCollectorUid&&this.$route.params.openCollectorUid.length&&this.openCollectorUid!==this.$route.params.openCollectorUid&&(this.openCollectorUid=this.$route.params.openCollectorUid)}},d=c,u=(o("b044"),o("2877")),m=o("9989"),g=o("e359"),h=o("b498"),y=o("65c6"),S=o("9c40"),C=o("eb85"),b=o("6ac5"),f=o("f09f"),v=o("a370"),w=o("eaac"),q=o("27f9"),_=o("0016"),k=o("05c0"),D=o("db86"),P=o("58ea"),N=o("66e5"),L=o("4074"),U=o("0170"),M=o("8380"),I=o("cb32"),O=o("58a8"),z=o("eebe"),x=o.n(z),F=Object(u["a"])(d,s,i,!1,null,"61cd70b1",null);t["default"]=F.exports;x()(F,"components",{QPage:m["a"],QHeader:g["a"],QColor:h["a"],QToolbar:y["a"],QBtn:S["a"],QSeparator:C["a"],QToolbarTitle:b["a"],QCard:f["a"],QCardSection:v["a"],QTable:w["a"],QInput:q["a"],QIcon:_["a"],QTooltip:k["a"],QTd:D["a"],QCircularProgress:P["a"],QItem:N["a"],QItemSection:L["a"],QItemLabel:U["a"],QSpinnerDots:M["a"],QAvatar:I["a"],QBadge:O["a"]})},"7d47":function(e,t,o){},b044:function(e,t,o){"use strict";o("7d47")}}]);