(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{3006:function(e,t,l){"use strict";l.r(t);var o=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("q-page",{staticClass:"q-gutter-sm q-pa-xl"},[l("q-header",{class:e.darkMode?"":"bg-grey-1",style:e.darkMode?"background: var(--q-color-dark);":"",attrs:{elevated:""}},[l("q-toolbar",{staticClass:"q-gutter-x-sm",class:e.darkMode?"":"text-black"},[l("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"arrow_back",label:"Return to Admin",to:"/Admin"}}),l("q-toolbar-title",{staticClass:"text-center",staticStyle:{opacity:".4"}},[e._v("Admin : RBAC : Manage User Roles")])],1)],1),l("q-card",{staticClass:"q-pa-md q-mx-none"},[l("q-card-section",{attrs:{horizontal:""}},[l("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[l("q-card-section",{staticClass:"text-h4"},[e._v("\n            User Roles\n        ")]),l("q-card-section",[l("q-table",{attrs:{data:e.tableData,columns:e.columns,"row-key":"roleUid",dense:"","no-data-label":"No Role to display.",filter:e.searchFilter,loading:e.dataLoading,"rows-per-page-label":"Roles per page:",pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[l("div",{staticClass:"full-width row wrap justify-between"},[l("div",{staticClass:"q-table__title"},[e._v("\n                  Roles\n                ")]),l("div",{staticClass:"row q-gutter-md"},[l("div",{staticClass:"col"},[l("q-btn",{staticStyle:{"min-width":"14rem"},attrs:{rounded:"",dense:"",color:"primary",icon:"add",label:"Add New Role"},on:{click:function(t){return e.addNewRole()}}},[l("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                        Create a new Role.\n                      ")])],1)],1)]),l("div",{staticClass:"row q-gutter-md"},[l("div",{staticStyle:{width:"300px"}},[l("q-input",{attrs:{outlined:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[e.searchFilter.length?l("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){e.searchFilter=""}}}):e._e(),l("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.searchFilter,callback:function(t){e.searchFilter=t},expression:"searchFilter"}})],1),l("q-btn",{attrs:{dense:"",outline:"",icon:"refresh",loading:e.dataLoading},on:{click:function(t){return e.loadRoles()}}},[l("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                      Reload the list of Roles.\n                    ")])],1)],1)])]},proxy:!0},{key:"body-cell-actions",fn:function(t){return[l("q-td",{attrs:{props:t}},[l("q-btn",{attrs:{flat:"",dense:"",icon:"edit"},on:{click:function(l){return e.doPromptForRoleDetails(t.row)}}},[l("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                    "+e._s(e.$t("Edit Role details"))+"\n                  ")])],1),l("q-btn",{attrs:{flat:"",dense:"",icon:"delete",color:"negative"},on:{click:function(l){return e.deleteRolePrompt(t.row)}}},[l("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                    "+e._s(e.$t("Delete Role"))+"\n                  ")])],1)],1)]}},{key:"body-cell-roleIsPrivileged",fn:function(t){return[l("q-td",{attrs:{props:t}},[1===t.value?l("q-icon",{attrs:{name:"check_circle_outline",color:"green",size:"md"}}):e._e(),l("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[1===t.value?l("span",[e._v("Privileged user")]):0===t.value?l("span",[e._v("Non-privileged user")]):l("span",[e._v(e._s(t.value))])])],1)]}}])})],1)],1),l("q-separator",{attrs:{vertical:""}}),l("q-card-actions",{staticClass:"justify-around q-px-md",attrs:{vertical:""}},[l("q-btn",{attrs:{icon:"add",color:"primary"},on:{click:function(t){return e.addNewRole()}}},[l("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[e._v("\n              Add Role\n            ")])],1),l("q-btn",{attrs:{icon:"refresh",loading:e.dataLoading},on:{click:function(t){return e.loadRoles()}}},[l("q-tooltip",{attrs:{"content-style":"font-size: 1rem;"}},[e._v("\n              Reload\n            ")])],1)],1)],1)],1),l("q-dialog",{attrs:{persistent:""},model:{value:e.promptForRoleDetails,callback:function(t){e.promptForRoleDetails=t},expression:"promptForRoleDetails"}},[l("q-card",{staticStyle:{"min-width":"350px"}},[l("q-card-section",[null!=e.editingRoleUid?l("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("User Role Details")))]):l("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("New User Role")))])]),l("q-card-section",{staticClass:"q-pt-none"},[l("q-input",{attrs:{dense:"",label:"Name",autofocus:"",rules:[function(t){return!!t||e.$t("Role Name cannot be empty")}]},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.promptForRoleDetails=!1}},model:{value:e.editingRoleName,callback:function(t){e.editingRoleName=t},expression:"editingRoleName"}})],1),l("q-card-section",{staticClass:"q-pt-none q-mb-md"},[l("q-toggle",{attrs:{label:"Is Privileged","false-value":"0","true-value":1,"left-label":""},model:{value:e.editingRoleIsPrivileged,callback:function(t){e.editingRoleIsPrivileged=t},expression:"editingRoleIsPrivileged"}})],1),l("q-separator"),l("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[l("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("Cancel")},on:{click:function(t){return e.cleanEditingVariables()}}}),null!=e.editingRoleUid?l("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("Update User Role"),disabled:!e.editingRoleName||!e.editingRoleName.length},on:{click:function(t){return e.addNewOrUpdateUserRole()}}}):l("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("Add new User Role"),disabled:!e.editingRoleName||!e.editingRoleName.length},on:{click:function(t){return e.addNewOrUpdateUserRole()}}})],1)],1)],1)],1)},a=[],i=l("2f62"),s=l("1732"),n=l("a87d"),r={name:"PageAdminRoles",mixins:[n["a"]],data(){return{searchFilter:"",columns:[{name:"actions",align:"center",label:"Actions",field:"actions",sortable:!1},{name:"roleName",align:"center",label:"Role",field:"roleName",sortable:!0},{name:"roleIsPrivileged",align:"center",label:"Is Privileged",field:"roleIsPrivileged",sortable:!0}],pagination:{sortBy:"roleName",descending:!1,rowsPerPage:20},rolesLoading:!1,promptForRoleDetails:!1,editingRoleUid:null,editingRoleName:null,editingRoleIsPrivileged:null}},computed:{...Object(i["d"])("mainStore",["userRoles"]),tableData(){return this.userRoles},dataLoading(){return this.rolesLoading}},methods:{...Object(i["b"])("mainStore",["getUserRoles","updateUserRole","deleteUserRole"]),loadRoles(){this.getUserRoles({loadingVariableName:"rolesLoading",caller:this})},cleanEditingVariables(){this.editingRoleUid=null,this.editingRoleName="",this.editingRoleIsPrivileged="0"},addNewRole(){this.cleanEditingVariables(),this.promptForRoleDetails=!0},doPromptForRoleDetails(e){console.log("doPromptForRoleDetails"),console.log(e),this.editingRoleUid=e&&e.roleUid?e.roleUid:null,this.editingRoleName=e&&e.roleName?e.roleName:"",this.editingRoleIsPrivileged=e&&e.roleIsPrivileged?e.roleIsPrivileged:"0",this.promptForRoleDetails=!0},addNewOrUpdateUserRole(){this.updateUserRole({roleUid:this.editingRoleUid&&this.editingRoleUid.length?this.editingRoleUid:Object(s["a"])(),roleName:this.editingRoleName,roleIsPrivileged:this.editingRoleIsPrivileged,loadingVariableName:"rolesLoading",caller:this,onSuccessCallBack:this.loadRoles,onErrorCallBack:this.addNewOrUpdateUserRoleFailure}),this.cleanEditingVariables()},addNewOrUpdateUserRoleFailure(e){this.$root.$emit("addAndShowErrorToErrorPanel",e),this.loadRoles()},deleteRolePrompt(e){this.$q.dialog({title:"Confirm",message:"Do you REALLY want to delete this User Role?",ok:{push:!0,color:"negative"},cancel:{push:!0,color:"positive"},persistent:!0}).onOk((()=>{this.deleteRole(e?e.roleUid:null)}))},deleteRole(e){console.log("deleteRole",e),e&&e.length&&this.deleteUserRole({roleUid:e,loadingVariableName:"rolesLoading",caller:this,onSuccessCallBack:this.loadRoles,onErrorCallBack:this.addNewOrUpdateUserRoleFailure})}},mounted(){this.userRoles&&0===this.userRoles.length&&this.loadRoles()}},d=r,c=l("2877"),p=l("9989"),u=l("e359"),g=l("b498"),m=l("65c6"),R=l("9c40"),b=l("6ac5"),h=l("f09f"),v=l("a370"),f=l("eaac"),q=l("05c0"),k=l("27f9"),U=l("0016"),w=l("eb85"),N=l("db86"),y=l("4b7e"),C=l("24e8"),_=l("9564"),P=l("7f67"),x=l("eebe"),F=l.n(x),I=Object(c["a"])(d,o,a,!1,null,null,null);t["default"]=I.exports;F()(I,"components",{QPage:p["a"],QHeader:u["a"],QColor:g["a"],QToolbar:m["a"],QBtn:R["a"],QToolbarTitle:b["a"],QCard:h["a"],QCardSection:v["a"],QTable:f["a"],QTooltip:q["a"],QInput:k["a"],QIcon:U["a"],QSeparator:w["a"],QTd:N["a"],QCardActions:y["a"],QDialog:C["a"],QToggle:_["a"]}),F()(I,"directives",{ClosePopup:P["a"]})}}]);